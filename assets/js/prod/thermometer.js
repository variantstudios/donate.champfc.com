var arrayOfImages,heightOfBody,mercuryId,tooltipId,goalAmount=2e4,animationTime=3e3,numberPrefix="$",numberSuffix="",tickMarkSegementCount=4,widthOfNumbers=50,glassTopImg="/assets/images/thermometer/glassTop.png",glassBodyImg="/assets/images/thermometer/glassBody.png",redVerticalImg="/assets/images/thermometer/redVertical.png",tooltipFGImg="/assets/images/thermometer/tickShine.png",glassBottomImg="/assets/images/thermometer/glassBottom.png",tootipPointImg="/assets/images/thermometer/tooltipPoint.png",tooltipMiddleImg="/assets/images/thermometer/tooltipMiddle.png",tooltipButtImg="/assets/images/thermometer/tooltipButt.png",glassTopImg2x="/assets/images/thermometer/glassTop2x.png",glassBodyImg2x="/assets/images/thermometer/glassBody2x.png",redVerticalImg2x="/assets/images/thermometer/redVertical2x.png",tooltipFGImg2x="/assets/images/thermometer/tickShine2x.png",glassBottomImg2x="/assets/images/thermometer/glassBottom2x.png",tootipPointImg2x="/assets/images/thermometer/tooltipPoint2x.png",tooltipMiddleImg2x="/assets/images/thermometer/tooltipMiddle2x.png",tooltipButtImg2x="/assets/images/thermometer/tooltipButt2x.png",imgsLoaded=0,tickHeight=40,mercuryHeightEmpty=0,numberStartY=6,thermTopHeight=13,thermBottomHeight=51,tooltipOffset=15,resolution2x=!1;function determineImageSet(){(resolution2x=2==window.devicePixelRatio)&&(glassTopImg=glassTopImg2x,glassBodyImg=glassBodyImg2x,redVerticalImg=redVerticalImg2x,glassBottomImg=glassBottomImg2x,tootipPointImg=tootipPointImg2x,tooltipButtImg=tooltipButtImg2x),createGraphics()}function createGraphics(){$("#goal-thermometer").html("<div id='therm-numbers'></div><div id='therm-graphics'><img id='therm-top' src='"+glassTopImg+"'></img><img id='therm-body-bg' src='"+glassBodyImg+"' ></img><img id='therm-body-mercury' src='"+redVerticalImg+"'></img><div id='therm-body-fore'></div><img id='therm-bottom' src='"+glassBottomImg+"'></img><div id='therm-tooltip'><img class='tip-left' src='"+tootipPointImg+"'></img><div class='tip-middle'><p>$0</p></div><img class='tip-right' src='"+tooltipButtImg+"'></img></div></div>"),$("<img/>").attr("src",tooltipFGImg).load(function(){$(this).remove(),$("#therm-body-fore").css("background-image","url('"+tooltipFGImg+"')"),checkIfAllImagesLoaded()}),$("<img/>").attr("src",tooltipMiddleImg).load(function(){$(this).remove(),$("#therm-tooltip .tip-middle").css("background-image","url('"+tooltipMiddleImg+"')"),checkIfAllImagesLoaded()}),heightOfBody=tickMarkSegementCount*tickHeight,$("#therm-graphics").css("left",widthOfNumbers),$("#therm-body-bg").css("height",heightOfBody),$("#goal-thermometer").css("height",heightOfBody+thermTopHeight+thermBottomHeight),$("#therm-body-fore").css("height",heightOfBody),$("#therm-bottom").css("top",heightOfBody+thermTopHeight),(mercuryId=$("#therm-body-mercury")).css("top",heightOfBody+thermTopHeight),(tooltipId=$("#therm-tooltip")).css("top",heightOfBody+thermTopHeight-tooltipOffset);for(var t=$("#therm-numbers"),e=goalAmount/tickMarkSegementCount,o=(commaSeparateNumber(e),0);o<tickMarkSegementCount;o++){var m=$("<style>.pos"+o+" { top: "+(tickHeight*o+numberStartY)+"px; width:"+widthOfNumbers+"px }</style>");$("html > head").append(m);var i=commaSeparateNumber(goalAmount-e*o);$(t).append("<div class='therm-number pos"+o+"'>"+i+"</div>")}preload(arrayOfImages=new Array("#therm-top","#therm-body-bg","#therm-body-mercury","#therm-bottom",".tip-left",".tip-right"))}function preload(t){for(i=0;i<t.length;i++)$(t[i]).load(function(){checkIfAllImagesLoaded()})}function checkIfAllImagesLoaded(){++imgsLoaded==arrayOfImages.length+2&&$("#goal-thermometer").fadeTo(1e3,1,function(){animateThermometer()})}function animateThermometer(){var t=currentAmount/goalAmount,e=Math.round(heightOfBody*t),o=heightOfBody+thermTopHeight-e;mercuryId.animate({height:e+1,top:o},animationTime),tooltipId.animate({top:o-tooltipOffset},{duration:animationTime});var m=$("#therm-tooltip .tip-middle p");$({tipAmount:0}).animate({tipAmount:currentAmount},{duration:animationTime,step:function(){m.html(commaSeparateNumber(this.tipAmount))}})}function commaSeparateNumber(t){for(t=Math.round(t);/(\d+)(\d{3})/.test(t.toString());)t=t.toString().replace(/(\d+)(\d{3})/,"$1,$2");return numberPrefix+t+numberSuffix}$(document).ready(function(){determineImageSet()});